<!DOCTYPE html>
<html lang="en">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" />
    <style>@import url('https://fonts.googleapis.com/css?family=Roboto:300');

* {
  box-sizing: border-box;
  font-family: 'Roboto', sans-serif;
}

table {
  width: 100%;
  font-size: 14px;
  color: black;
}

thead {
  background-color: gray;
  color: white;
}

th,
 td {
  border: 0;
  border-bottom: 1px solid gray;
  height: 50px;
  border-right: 1px solid gray;
  text-align: center;
}

a {
  width: 100%;
  height: 100%;
  display: block;
  text-align: center;
  padding-top: 15px;
  color: inherit;
  text-decoration: none;
  font-weight: bold;
}

a:hover {
  background-color: black;
  color: white;
}

select {
  width: 38%;
  height: 100%;
}

textarea {
  display: block;
  margin: 0 auto;
  width: 99%;
  height: 100%;
}</style>
    <title>ha.ze.gs</title>
  </head>
  <body>
    <table>
      <thead>
        <tr>
          <th>Switch</th>
          <th><a href="http://a.ze.gs/hue/lights/off" data-api='["hue","lights","off"]'>All light OFF</a></th>
          <th>&nbsp;</th>
          <th>&nbsp;</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td id="Living">Living</td>
          <td><a href="http://a.ze.gs/switchbot-command/-d/02-202102231815-37239298/-c/turnOn" data-api='["switchbot-command","-d","02-202102231815-37239298","-c","turnOn"]'>On/Off</a></td>
          <td>&nbsp;</td>
          <td>&nbsp;</td>
        </tr>
        <tr>
          <td id="Dining">Dining</td>
          <td><a href="http://a.ze.gs/hue/lights/13,14,15,28,29/on" data-api='["hue","lights","13,14,15,28,29","on"]'>On</a></td>
          <td>&nbsp;</td>
          <td><a href="http://a.ze.gs/hue/lights/13,14,15,28,29/off" data-api='["hue","lights","13,14,15,28,29","off"]'>Off</a></td>
        </tr>
        <tr>
          <td id="Tatami">Tatami</td>
          <td><a href="http://a.ze.gs/switchbot-command/-d/ECCC4C8C52C3/-c/turnOn" data-api='["switchbot-command","-d","ECCC4C8C52C3","-c","turnOn"]'>On</a></td>
          <td>&nbsp;</td>
          <td><a href="http://a.ze.gs/switchbot-command/-d/ECCC4C8C52C3/-c/turnOff" data-api='["switchbot-command","-d","ECCC4C8C52C3","-c","turnOff"]'>Off</a></td>
        </tr>
        <tr>
          <td id="Downright">Down right</td>
          <td><a href="http://a.ze.gs/hue/lights/27/on" data-api='["hue","lights","27","on"]'>On</a></td>
          <td>&nbsp;</td>
          <td><a href="http://a.ze.gs/hue/lights/27/off" data-api='["hue","lights","27","off"]'>Off</a></td>
        </tr>
        <tr>
          <td id="Downleft">Down left</td>
          <td><a href="http://a.ze.gs/hue/lights/26/on" data-api='["hue","lights","26","on"]'>On</a></td>
          <td>&nbsp;</td>
          <td><a href="http://a.ze.gs/hue/lights/26/off" data-api='["hue","lights","26","off"]'>Off</a></td>
        </tr>
        <tr>
          <td id="Downback">Down back</td>
          <td><a href="http://a.ze.gs/hue/lights/7/on" data-api='["hue","lights","7","on"]'>On</a></td>
          <td>&nbsp;</td>
          <td><a href="http://a.ze.gs/hue/lights/7/off" data-api='["hue","lights","7","off"]'>Off</a></td>
        </tr>
        <tr>
          <td id="Washroom">Washroom</td>
          <td><a href="http://a.ze.gs/hue/lights/22/on" data-api='["hue","lights","22","on"]'>On</a></td>
          <td>&nbsp;</td>
          <td><a href="http://a.ze.gs/hue/lights/22/off" data-api='["hue","lights","22","off"]'>Off</a></td>
        </tr>
        <tr>
          <td id="Bathroom">Bathroom</td>
          <td><a href="http://a.ze.gs/hue/lights/8,9/on" data-api='["hue","lights","8,9","on"]'>On</a></td>
          <td>&nbsp;</td>
          <td><a href="http://a.ze.gs/hue/lights/8,9/off" data-api='["hue","lights","8,9","off"]'>Off</a></td>
        </tr>
        <tr>
          <td id="Corridor">Corridor</td>
          <td><a href="http://a.ze.gs/hue/lights/21,16/on" data-api='["hue","lights","21,16","on"]'>On</a></td>
          <td>&nbsp;</td>
          <td><a href="http://a.ze.gs/hue/lights/21,16/off" data-api='["hue","lights","21,16","off"]'>Off</a></td>
        </tr>
        <tr>
          <td id="Restroom">Restroom</td>
          <td><a href="http://a.ze.gs/hue/lights/10/on" data-api='["hue","lights","10","on"]'>On</a></td>
          <td>&nbsp;</td>
          <td><a href="http://a.ze.gs/hue/lights/10/off" data-api='["hue","lights","10","off"]'>Off</a></td>
        </tr>
        <tr>
          <td id="Chiemi">Chiemi</td>
          <td><a href="http://a.ze.gs/hue/lights/18,19,20/on" data-api='["hue","lights","18,19,20","on"]'>On</a></td>
          <td>&nbsp;</td>
          <td><a href="http://a.ze.gs/hue/lights/18,19,20/off" data-api='["hue","lights","18,19,20","off"]'>Off</a></td>
        </tr>
        <tr>
          <td id="AC">
            <a href="#" data-status-action="control">A/C</a>
          </td>
          <td>
            <a
              href="http://a.ze.gs/switchbot-ac/-d/02-202307290753-22894539/-a/28,2,1,on"
              data-api='["switchbot-ac","-d","02-202307290753-22894539","-a","28,2,1,on"]'
              data-status-action="cool"
              >Cool</a
            >
          </td>
          <td>
            <a
              href="http://a.ze.gs/switchbot-ac/-d/02-202307290753-22894539/-a/28,5,1,on"
              data-api='["switchbot-ac","-d","02-202307290753-22894539","-a","28,5,1,on"]'
              data-status-action="hot"
              >Hot</a
            >
          </td>
          <td>
            <a
              href="http://a.ze.gs/switchbot-ac/-d/02-202307290753-22894539/-a/25,2,1,off"
              data-api='["switchbot-ac","-d","02-202307290753-22894539","-a","25,2,1,off"]'
              data-status-action="off"
              >Off</a
            >
          </td>
        </tr>
        <tr>
          <td id="TatamiAC">Tatami A/C</td>
          <td><a href="http://a.ze.gs/switchbot-custom/-d/03-202401251013-58699638/-c/Cool" data-api='["switchbot-custom","-d","03-202401251013-58699638","-c","Cool"]'>Cool</a></td>
          <td><a href="http://a.ze.gs/switchbot-custom/-d/03-202401251013-58699638/-c/Hot" data-api='["switchbot-custom","-d","03-202401251013-58699638","-c","Hot"]'>Hot</a></td>
          <td><a href="http://a.ze.gs/switchbot-custom/-d/03-202401251013-58699638/-c/Off" data-api='["switchbot-custom","-d","03-202401251013-58699638","-c","Off"]'>Off</a></td>
        </tr>
        <tr>
          <td>Tool</td>
          <td><a href="http://a.ze.gs/switchbot-command/-d/D23403D2D43D/-c/press" data-api='["switchbot-command","-d","D23403D2D43D","-c","press"]'>HeatFloor</a></td>
          <td>&nbsp;</td>
          <td>
            <a
              href="http://a.ze.gs/google-home-speaker-wrapper/-h/192.168.1.22/-v/60/-s/%E3%83%81%E3%82%A8%E3%83%9F%E3%81%95%E3%82%93%E3%80%81%E3%83%9E%E3%83%9E%E3%81%95%E3%82%93%E3%80%81%E3%83%91%E3%83%91%E3%81%8C%E5%88%B0%E7%9D%80%E3%81%97%E3%81%BE%E3%81%97%E3%81%9F%E3%80%82%E6%BA%96%E5%82%99%E3%82%92%E3%81%8A%E9%A1%98%E3%81%84%E3%81%97%E3%81%BE%E3%81%99%E3%80%82"
              data-message-key="car-arrival"
              >CarArrives</a
            >
          </td>
        </tr>
        <tr>
          <td id="Fan">Fan</td>
          <td><a href="http://a.ze.gs/switchbot-command/-d/03-202401251013-89002900/-c/turnOn" data-api='["switchbot-command","-d","03-202401251013-89002900","-c","turnOn"]'>On/Off</a></td>
          <td><a href="http://a.ze.gs/switchbot-command/-d/03-202401251013-89002900/-c/highSpeed" data-api='["switchbot-command","-d","03-202401251013-89002900","-c","highSpeed"]'>Turbo</a></td>
          <td><a href="http://a.ze.gs/switchbot-command/-d/03-202401251013-89002900/-c/swing" data-api='["switchbot-command","-d","03-202401251013-89002900","-c","swing"]'>Swing</a></td>
        </tr>
        <tr>
          <td id="NW">Nest WiFi</td>
          <td><a href="http://a.ze.gs/catt/-d/192.168.1.22/volumeup" data-api='["catt","-d","host:nest","volumeup"]'>+</a></td>
          <td><a href="http://a.ze.gs/catt/-d/192.168.1.22/volumedown" data-api='["catt","-d","host:nest","volumedown"]'>-</a></td>
          <td><a href="http://a.ze.gs/catt/-d/192.168.1.22/stop" data-api='["catt","-d","host:nest","stop"]'>Off</a></td>
        </tr>
        <tr>
          <td id="TW">Tatami WiFi</td>
          <td><a href="http://a.ze.gs/catt/-d/192.168.1.236/volumeup" data-api='["catt","-d","host:tatami","volumeup"]'>+</a></td>
          <td><a href="http://a.ze.gs/catt/-d/192.168.1.236/volumedown" data-api='["catt","-d","host:tatami","volumedown"]'>-</a></td>
          <td><a href="http://a.ze.gs/catt/-d/192.168.1.236/stop" data-api='["catt","-d","host:tatami","stop"]'>Off</a></td>
        </tr>
        <tr>
          <td id="CC">TV</td>
          <td><a href="http://a.ze.gs/catt/-d/192.168.1.219/volumeup" data-api='["catt","-d","host:tv","volumeup"]'>+</a></td>
          <td><a href="http://a.ze.gs/catt/-d/192.168.1.219/volumedown" data-api='["catt","-d","host:tv","volumedown"]'>-</a></td>
          <td><a href="http://a.ze.gs/catt/-d/192.168.1.219/stop" data-api='["catt","-d","host:tv","stop"]'>Off</a></td>
        </tr>
        <tr>
          <td id="YouTube"><a href="#" data-youtube-key="tv">YouTube</a></td>
          <td><textarea id="youtube_url"></textarea></td>
          <td><a href="#" data-youtube-key="nest">Nest Wifi</a></td>
          <td><a href="#" data-youtube-key="tatami">Tatami WiFi</a></td>
        </tr>
        <tr>
          <td id="Voice">Voice</td>
          <td><textarea id="voicetext"></textarea></td>
          <td><a id="speak" href="#">Nest Wifi</a></td>
          <td><a id="speak_tatami" href="#">Tatami</a></td>
        </tr>
        <tr>
          <td id="Alarm">Alarm</td>
          <td>
            <select id="hour">
              <option value="00">00</option>
              <option value="01">01</option>
              <option value="02">02</option>
              <option value="03">03</option>
              <option value="04">04</option>
              <option value="05">05</option>
              <option value="06">06</option>
              <option value="07">07</option>
              <option value="08">08</option>
              <option value="09">09</option>
              <option value="10">10</option>
              <option value="11">11</option>
              <option value="12">12</option>
              <option value="13">13</option>
              <option value="14">14</option>
              <option value="15">15</option>
              <option value="16">16</option>
              <option value="17">17</option>
              <option value="18">18</option>
              <option value="19">19</option>
              <option value="20">20</option>
              <option value="21">21</option>
              <option value="22">22</option>
              <option value="23">23</option>
            </select>
            :
            <select id="min">
              <option value="00">00</option>
              <option value="01">01</option>
              <option value="02">02</option>
              <option value="03">03</option>
              <option value="04">04</option>
              <option value="05">05</option>
              <option value="06">06</option>
              <option value="07">07</option>
              <option value="08">08</option>
              <option value="09">09</option>
              <option value="10">10</option>
              <option value="11">11</option>
              <option value="12">12</option>
              <option value="13">13</option>
              <option value="14">14</option>
              <option value="15">15</option>
              <option value="16">16</option>
              <option value="17">17</option>
              <option value="18">18</option>
              <option value="19">19</option>
              <option value="20">20</option>
              <option value="21">21</option>
              <option value="22">22</option>
              <option value="23">23</option>
              <option value="24">24</option>
              <option value="25">25</option>
              <option value="26">26</option>
              <option value="27">27</option>
              <option value="28">28</option>
              <option value="29">29</option>
              <option value="30">30</option>
              <option value="31">31</option>
              <option value="32">32</option>
              <option value="33">33</option>
              <option value="34">34</option>
              <option value="35">35</option>
              <option value="36">36</option>
              <option value="37">37</option>
              <option value="38">38</option>
              <option value="39">39</option>
              <option value="40">40</option>
              <option value="41">41</option>
              <option value="42">42</option>
              <option value="43">43</option>
              <option value="44">44</option>
              <option value="45">45</option>
              <option value="46">46</option>
              <option value="47">47</option>
              <option value="48">48</option>
              <option value="49">49</option>
              <option value="50">50</option>
              <option value="51">51</option>
              <option value="52">52</option>
              <option value="53">53</option>
              <option value="54">54</option>
              <option value="55">55</option>
              <option value="56">56</option>
              <option value="57">57</option>
              <option value="58">58</option>
              <option value="59">59</option>
            </select>
          </td>
          <td><textarea id="alarmtext"></textarea></td>
          <td><a id="set" href="#">Set</a></td>
        </tr>
        <tr>
          <td id="AirCondition">AirCondition</td>
          <td id="Date">&nbsp;</td>
          <td id="Temperature">&nbsp;</td>
          <td id="Humid">&nbsp;</td>
        </tr>
      </tbody>
    </table>

    <script>const API_BASE_URL="http://a.ze.gs";const DEVICE_HOSTS={nest:"192.168.1.22",tatami:"192.168.1.236",tv:"192.168.1.219"};const VOICE_HOSTS={speak:DEVICE_HOSTS.nest,speakTatami:DEVICE_HOSTS.tatami};const ALARM_SCRIPT_URL="https://script.google.com/macros/s/AKfycbyGtgeNC_rHFxPvSj7XjO5GdM6awoqlxJ7PDmfcadghjZshQ8Y/exec";const STATUS_SCRIPT_URL="https://script.google.com/macros/s/AKfycbyedXl6ic-uZR0LDrWgpw9madWl0374RNxz7EIB1m4wMnYsVZnT3rfVt4OQ8tDb1R8YOQ/exec";const YOUTUBE_HOSTS=new Set(["youtube.com","www.youtube.com","m.youtube.com","music.youtube.com"]);const CAR_ARRIVAL_MESSAGE="チエミさん、ママさん、パパが到着しました。準備をお願いします。";const STATUS_CALLBACK="__statusCallback";const STATUS_KEYS=["Date","Temperature","Humid"];const REQUIRED_IDS=["voicetext","speak","speak_tatami","hour","min","alarmtext","set"];const sanitizeText=(v)=>encodeURIComponent(v.replace(/[\s\n\r]/g,""));const getRequiredElements=(d,ids)=>Object.fromEntries(ids.map((id)=>[id,d.getElementById(id)]));const buildStatusUrl=(p={})=>`${STATUS_SCRIPT_URL}?${new URLSearchParams(p)}`;const padTime=(v)=>String(v).padStart(2,"0");const apiUrl=(a)=>`${API_BASE_URL}/${a.join("/")}`;const buildVoiceUrls=(t)=>{const s=sanitizeText(t);return{speak:`${API_BASE_URL}/google-home-speaker-wrapper/-h/${VOICE_HOSTS.speak}/-v/60/-s/${s}`,speakTatami:`${API_BASE_URL}/google-home-speaker-wrapper/-h/${VOICE_HOSTS.speakTatami}/-v/60/-s/${s}`};};const updateVoiceLinks=(t,e)=>{const{ speak, speakTatami }=buildVoiceUrls(t);e.speak.dataset.url=speak;e.speakTatami.dataset.url=speakTatami;e.speak.setAttribute("href","#");e.speakTatami.setAttribute("href","#");};const buildAlarmUrl=(h,m,t)=>{const s=sanitizeText(t);return`${ALARM_SCRIPT_URL}?time=${h}:${m}:00&text=${s}`;};const parseYouTubeId=(u)=>{try{const p=new URL(u);if(p.hostname==="youtu.be"){return p.pathname.split("/")[1]||"";}if(!YOUTUBE_HOSTS.has(p.hostname)){return"";}const h=[{match:()=>p.pathname==="/watch",getId:()=>p.searchParams.get("v")||""},{match:()=>p.pathname.startsWith("/live/")||p.pathname.startsWith("/shorts/"),getId:()=>p.pathname.split("/")[2]||""}];const f=h.find(({match})=>match());return f?f.getId():"";}catch(error){return"";}};const buildYouTubePlayUrl=(h,u)=>{const v=parseYouTubeId(u);return`${API_BASE_URL}/youtube-play/-h/${h}/-v/40/-i/${v}`;};const buildCarArrivalArgs=()=>["google-home-speaker-wrapper","-h",DEVICE_HOSTS.nest,"-v",60,"-s",sanitizeText(CAR_ARRIVAL_MESSAGE)];const resolveHost=(v)=>DEVICE_HOSTS[v]??v;const replaceHostTokens=(a)=>a.map((arg)=>typeof arg==="string"&&arg.startsWith("host:")?resolveHost(arg.slice(5)):arg);const parseLatestPayload=(p)=>{const c=p.replace(new RegExp(`^${STATUS_CALLBACK}&&${STATUS_CALLBACK}\\(`),"").replace(/\);$/,"");const r=JSON.parse(c);return Array.isArray(r)?r.pop():null;};const fetchLatestStatus=async(f)=>{const r=await f(buildStatusUrl({callback:STATUS_CALLBACK}));const p=await r.text();return parseLatestPayload(p);};const formatDateTimeLocal=(v)=>{const p=new Date(v);if(Number.isNaN(p.getTime())){return v;}return new Intl.DateTimeFormat("en-US",{month:"short",day:"numeric",hour:"2-digit",minute:"2-digit",hour12:false}).format(p).replace(",","");};const updateStatusCells=(l,e)=>{STATUS_KEYS.forEach((k)=>{const v=l[k];if(k==="Date"){e[k].innerText=formatDateTimeLocal(v);return;}e[k].innerText=k==="Temperature"?`${v}C`:`${v}%`;});};const setAlarmDefaults=(hs,ms,n=new Date())=>{const s=(sel,v)=>{if(sel.querySelector(`option[value="${v}"]`)){sel.value=v;}};s(hs,padTime(n.getHours()));s(ms,padTime(n.getMinutes()));};const initApp=(d,f=fetch)=>{const r=getRequiredElements(d,REQUIRED_IDS);const sc=getRequiredElements(d,STATUS_KEYS);if(Object.values(r).some((e)=>!e)){return null;}const{ voicetext, speak, speak_tatami:speakTatami, hour, min, alarmtext, set:setButton }=r;const youtubeUrl=d.getElementById("youtube_url");setAlarmDefaults(hour,min);voicetext.addEventListener("input",()=>{updateVoiceLinks(voicetext.value,{speak,speakTatami});});const setAlarm=()=>f(buildAlarmUrl(hour.value,min.value,alarmtext.value));const youtubePlay=(h)=>{if(!youtubeUrl){return null;}if(!parseYouTubeId(youtubeUrl.value)){youtubeUrl.value="";return null;}return f(buildYouTubePlayUrl(h,youtubeUrl.value));};const fetchLatest=async()=>{if(Object.values(sc).some((e)=>!e)){return null;}const latest=await fetchLatestStatus(f);updateStatusCells(latest,sc);return latest;};return{setAlarm,youtubePlay,fetchLatest,elements:{voicetext,speak,speakTatami,hour,min,alarmtext,setButton,youtubeUrl,statusCells:sc}};};

import{apiUrl,buildCarArrivalArgs,buildStatusUrl,initApp,parseYouTubeId,replaceHostTokens,resolveHost}from"./logic.js";const bindLinkClicks=(d,s,h)=>{d.querySelectorAll(s).forEach((l)=>{l.addEventListener("click",(e)=>{e.preventDefault();h(l);});});};const wireEvents=(d,f,i)=>{const{setAlarm:sa,youtubePlay:yp,elements:el}=i;el.setButton.addEventListener("click",async(e)=>{e.preventDefault();await sa();el.alarmtext.value="";});el.youtubeUrl.addEventListener("blur",()=>{if(el.youtubeUrl.value&&!parseYouTubeId(el.youtubeUrl.value)){el.youtubeUrl.value="";}});bindLinkClicks(d,"a[data-api], a[data-fetch], a[data-status-action], a[data-message-key]",async(l)=>{if(l.dataset.api){await f(apiUrl(replaceHostTokens(JSON.parse(l.dataset.api))));}if(l.dataset.messageKey==="car-arrival"){await f(apiUrl(buildCarArrivalArgs()));}if(l.dataset.fetch){await f(l.dataset.fetch);}if(l.dataset.statusAction){await f(buildStatusUrl({s:"status",t:l.dataset.statusAction}));}});bindLinkClicks(d,"a[data-youtube-host], a[data-youtube-key]",async(l)=>{const h=l.dataset.youtubeHost??resolveHost(l.dataset.youtubeKey);if(!h){return;}const r=await yp(h);if(r){el.youtubeUrl.value="";}});[el.speak,el.speakTatami].forEach((l)=>{l.addEventListener("click",async(e)=>{e.preventDefault();if(l.dataset.url){await f(l.dataset.url);el.voicetext.value="";}});});};const start=(d=document,f=fetch)=>{const i=initApp(d,f);if(!i){return null;}const{fetchLatest:fl}=i;d.querySelectorAll("a").forEach((l)=>{l.setAttribute("href","#");});wireEvents(d,f,i);fl();return i;};if(typeof window!=="undefined"){const i=start(document,fetch);window.api=(a)=>{fetch(apiUrl(a));};window.setAlarm=()=>i?.setAlarm();window.youtubePlay=(h)=>i?.youtubePlay(h);}</script>
  </body>
</html>
